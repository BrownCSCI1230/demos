<!DOCTYPE html>
<html lang="en">
<head>
  <title>Additive Colormixing</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="index.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<!--  <script src="res/pixi.min.js"></script>
  <script type="text/javascript" src="app.js"></script> -->
</head>
<body>

    <div class="dropdown">
    <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Canvases</button>
  	<div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
    <a class="dropdown-item" href="#" onclick="changeCanvas()">Colorfield</a>
    <a class="dropdown-item" href="#" onclick="changePaintCanvas()">Paint Canvas</a>
    <a class="dropdown-item" href="#" onclick="enterURL()">URL Image</a>
    <a class="dropdown-item" href="#" onclick="enterFileUpload()">Upload File</a>
  </div>
  </div>

  <div id="urlForm">
  Enter an image URL:
	<input id="url" placeholder="http://250.browndailyherald.com/wp-content/uploads/2014/05/Van-dam_-Alana-Tisdale-700x465.jpg" type="text">
	<button class="btn btn-primary" type="button" href="" id="submitUrl" onclick="changeCanvasURL()">Submit</button>
  </div>

  <div id="fileUpload">
  Upload an image file:
  	<input type="file" id="uploadFile">
  	<button class="btn btn-primary" type="button" href="" id="submitFile"  onclick="uploadFile()">Submit</button>
  </div>

<div class="container">
  <div class="row">
    <div class="col-sm-9" id="app">
    <canvas id="canvas"></canvas>
    </div>
    <div class="col-sm-3">
      <p>Color Components</p>
      <div class="container" id="bars">
      <div class="col-sm-3" id="redBar">
      	<div id="redColored"></div>
      </div>
      <div class="col-sm-3" id="greenBar">
      	<div id="greenColored"></div>
      </div>
      <div class="col-sm-3" id="blueBar">
      	<div id="blueColored"></div>
      </div>
      </div>
      <p>Color Selector</p>
     <button onclick="changeRed()" id="red">
     	<img src="images/redBulbOff.gif">
     </button>
     <button onclick="changeGreen()" id="green">
     	<img src="images/greenBulbOff.gif">
     </button>
     <button onclick="changeBlue()" id="blue">
     	<img src="images/blueBulbOff.gif">
     </button>
      <p>Alpha</p>
      <input type="number" id="alphaNumber">
      <input type="range" min="0" max="100" value="50" class="slider" onchange="updateAlpha(this.value)" id="alphaSlider">
    </div>
  </div>
</div>
</body>
<script>
	function updateAlpha(val) {
          document.getElementById('alphaNumber').value=val; 
    }

 	var canvas = document.getElementById('canvas');
	var ctx = canvas.getContext('2d');
 	var painting = document.getElementById('paint');
 	var offset = 120;
  	var width = window.innerWidth - 4 * offset;
  	var height = window.innerHeight - offset;
	canvas.width = width;
	canvas.height = height;

	var mouse = {x: 0, y: 0};
		 
	ctx.fillStyle = "black";
	ctx.fillRect(0, 0, canvas.width, canvas.height);

	canvas.addEventListener('mousemove', function(e) {
		var x = e.pageX - 70;
		var y = e.pageY - 30;
		var index = (Math.floor(y) * canvas.width + Math.floor(x)) * 4;
		var red = imageData.data[index];
		var green = imageData.data[index + 1];
		var blue = imageData.data[index + 2];
		var blue = imageData.data[index + 2];
	    
	    var redBar = document.getElementById('redColored');
		var greenBar = document.getElementById('greenColored');
	    var blueBar = document.getElementById('blueColored');
	    // RED
	    if(red == 0) {
	    	redBar.style.height = "0%";
	    } else if(red > 0 && red < 125) {
			redBar.style.height = "50%";
	    } else {
			redBar.style.height = "100%";
	    }
	    // GREEN
	    if(green == 0) {
			greenBar.style.height = "0%";
	    } else if(green > 0 && green < 125) {
			greenBar.style.height = "50%";
	    } else {
			greenBar.style.height = "100%";
	    }
	    // BLUE
	    if(blue == 0) {
			blueBar.style.height = "0%";
	    } else if(blue > 0 && blue < 125) {
			blueBar.style.height = "50%";
	    } else {
			blueBar.style.height = "100%";
	    }


	} , false);

	var img = new Image();
	img.src = "images/rgbColorfieldCanvas.jpg";
	var imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
	img.onload = function () {
		var canvas = document.getElementById('canvas');
		var ctx = canvas.getContext('2d');
    	ctx.drawImage(img,canvas.width / 4,canvas.height / 4);
		imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
	};
	 
	canvas.addEventListener('mousemove', function(e){
		mouse.x = e.pageX - this.offsetLeft;
		mouse.y = e.pageY - this.offsetTop;
	}, false); 

var onPaint = function() {
    ctx.lineTo(mouse.x, mouse.y);
    ctx.stroke();
    imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
};

var drawPaint = function(e) {
	    	ctx.beginPath();
	    	ctx.moveTo(mouse.x, mouse.y);
	    	canvas.addEventListener('mousemove', onPaint, false);
}	

var stopPaint = function() {
		    canvas.removeEventListener('mousemove', onPaint, false);	
};	
	
	function changeRed(e) {
		ctx.strokeStyle = '#00ff00';
	}

	function changeGreen(e) {
		ctx.strokeStyle = '#00ff00';
	}

	function changeBlue(e) {
		ctx.strokeStyle = '#0000ff';
	}

var colorField = true;	
var changeCanvas = function() {
	if(!colorField) {
		ctx.fillStyle = "black";
		ctx.fillRect(0, 0, canvas.width, canvas.height);
		var img = new Image();
		img.src = "images/rgbColorfieldCanvas.jpg";
		img.onload = function () {
			var canvas = document.getElementById('canvas');
			var ctx = canvas.getContext('2d');
	    	ctx.drawImage(img,width / 4,height / 4);

		};
		canvas.removeEventListener('mousedown', drawPaint);
		canvas.removeEventListener('mouseup', stopPaint);
		colorField = true;
	} else {
		ctx.fillStyle = "black";
		ctx.fillRect(0, 0, canvas.width, canvas.height);
		ctx.lineWidth = 3;
		ctx.lineJoin = 'round';
		ctx.lineCap = 'round';
		ctx.strokeStyle = '#ff0000';
		canvas.addEventListener('mousedown', drawPaint, false);
		canvas.addEventListener('mouseup', stopPaint, false);
		colorField = false;
	}
};

var changeColorfield = function() {
		ctx.fillStyle = "black";
		ctx.fillRect(0, 0, canvas.width, canvas.height);
		var img = new Image();
		img.src = "images/rgbColorfieldCanvas.jpg";
		img.onload = function () {
			var canvas = document.getElementById('canvas');
			var ctx = canvas.getContext('2d');
	    	ctx.drawImage(img,width / 4,height / 4);

		};
		canvas.removeEventListener('mousedown', drawPaint);
		canvas.removeEventListener('mouseup', stopPaint);
		colorField = true;
};

var changePaintCanvas = function() {
	urlForm.style.display = "none";
	fileUpload.style.display = "none";
		ctx.fillStyle = "black";
		ctx.fillRect(0, 0, canvas.width, canvas.height);
		ctx.lineWidth = 3;
		ctx.lineJoin = 'round';
		ctx.lineCap = 'round';
		ctx.strokeStyle = '#ff0000';
		canvas.addEventListener('mousedown', drawPaint, false);
		canvas.addEventListener('mouseup', stopPaint, false);
		colorField = false;
};

var uploadFile = function() {
	var submitFile = document.getElementById('submitFile');
	urlForm.style.display = "none";
	fileUpload.style.display = "none";
		ctx.fillStyle = "black";
		ctx.fillRect(0, 0, canvas.width, canvas.height);
		var reader = new FileReader();
    	reader.onload = function(event){
		var img = new Image();
		img.src = event.target.result;
		img.onload = function () {
			var canvas = document.getElementById('canvas');
			var ctx = canvas.getContext('2d');
	    	ctx.drawImage(img,width / 4,height / 4);

		};
		reader.readAsDataURL(submitFile.value);
	};
		canvas.removeEventListener('mousedown', drawPaint);
		canvas.removeEventListener('mouseup', stopPaint);
		colorField = true;
};

var changeCanvasURL = function() {
		var urlStr = document.getElementById('url');
		console.log(urlStr.value);
		ctx.fillStyle = "black";
		ctx.fillRect(0, 0, canvas.width, canvas.height);
		var img = new Image();
		img.src = urlStr.value;
		img.onload = function () {
			var canvas = document.getElementById('canvas');
			var ctx = canvas.getContext('2d');
	    	ctx.drawImage(img,width / 4,height / 4);

		};
		canvas.removeEventListener('mousedown', drawPaint);
		canvas.removeEventListener('mouseup', stopPaint);
		colorField = true;
};

var enterFileUpload = function() {
	var fileUpload = document.getElementById('fileUpload');
	if (fileUpload.style.display === "none") {
        fileUpload.style.display = "block";
    } else {
        fileUpload.style.display = "none";
    }
}

var enterURL = function() {
	var urlForm = document.getElementById('urlForm');
	if (urlForm.style.display === "none") {
        urlForm.style.display = "block";
    } else {
        urlForm.style.display = "none";
    }
}

var urlForm = document.getElementById('urlForm');
var fileUpload = document.getElementById('fileUpload');
urlForm.style.display = "none";
fileUpload.style.display = "none";
 </script>
</html>
